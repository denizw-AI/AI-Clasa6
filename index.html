<!DOCTYPE html>
<html lang="ro">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>AI Clasa a VI-a — Română și Matematică</title>
  <style>
    :root{
      --bg:#f4f6f8;
      --card:#ffffff;
      --accent:#0b66ff;
      --text:#162029;
      --muted:#556270;
      --radius:12px;
      --gap:14px;
      --maxw:900px;
    }
    html,body{
      height:100%;
      margin:0;
      font-family: Inter, system-ui, -apple-system, "Segoe UI", Roboto, "Helvetica Neue", Arial;
      background:linear-gradient(180deg,var(--bg),#eef2f7);
      color:var(--text);
      -webkit-font-smoothing:antialiased;
      -moz-osx-font-smoothing:grayscale;
    }
    .wrap{
      max-width:var(--maxw);
      margin:20px auto;
      padding:18px;
    }
    header{
      display:flex;
      align-items:center;
      justify-content:space-between;
      gap:12px;
      margin-bottom:12px;
    }
    header h1{
      margin:0;
      font-size:20px;
      line-height:1.05;
      letter-spacing:-0.2px;
    }
    header p{
      margin:0;
      color:var(--muted);
      font-size:13px;
    }
    .card{
      background:var(--card);
      border-radius:var(--radius);
      padding:16px;
      box-shadow:0 6px 18px rgba(15,23,42,0.06);
    }
    .controls{
      display:flex;
      gap:8px;
      flex-wrap:wrap;
      margin-top:12px;
    }
    textarea#intrebare{
      width:100%;
      min-height:110px;
      resize:vertical;
      padding:12px;
      border-radius:10px;
      border:1px solid rgba(15,23,42,0.06);
      font-size:15px;
      box-sizing:border-box;
      outline:none;
    }
    .row{
      display:flex;
      gap:8px;
      align-items:center;
      margin-top:12px;
      flex-wrap:wrap;
    }
    button{
      background:var(--accent);
      color:white;
      border:none;
      padding:10px 14px;
      border-radius:10px;
      font-size:14px;
      cursor:pointer;
      box-shadow:0 4px 10px rgba(11,102,255,0.12);
    }
    button.secondary{
      background:#eef3ff;
      color:var(--accent);
      box-shadow:none;
      border:1px solid rgba(11,102,255,0.08);
    }
    .small{
      padding:8px 10px;
      font-size:13px;
      border-radius:8px;
    }
    #raspuns{
      margin-top:16px;
      padding:14px;
      background:#fff;
      border-radius:10px;
      text-align:left;
      line-height:1.45;
      font-size:15px;
      box-shadow:0 6px 14px rgba(15,23,42,0.04);
      white-space:pre-wrap;
    }
    .signature{
      position:fixed;
      right:14px;
      bottom:10px;
      background:rgba(0,0,0,0.06);
      padding:8px 10px;
      border-radius:999px;
      font-size:13px;
      color:var(--muted);
      backdrop-filter:blur(4px);
    }
    /* responsive */
    @media (max-width:600px){
      header{flex-direction:column;align-items:flex-start;gap:6px}
      .row{flex-direction:column;align-items:stretch}
      button{width:100%}
      .controls{flex-direction:column}
      :root{--maxw:95%}
    }
  </style>
</head>
<body>
  <div class="wrap">
    <header>
      <div>
        <h1>AI Clasa a VI-a</h1>
        <p>Română și Matematică, rezumate lungi, calcule rapide, voce și responsive</p>
      </div>
      <div style="text-align:right">
        <small style="color:var(--muted)">Proiect educațional</small>
      </div>
    </header>

    <div class="card">
      <label for="intrebare" style="font-weight:600">Scrie sau spune întrebarea</label>
      <textarea id="intrebare" placeholder="Exemple: rezumat Harap Alb, rezumat Cenușăreasa, 8+9, 45:5, explică ecuații simple"></textarea>

      <div class="controls">
        <button onclick="genereazaRaspuns()" class="small">Răspunde</button>
        <button onclick="vorbeste()" class="secondary small">🎤 Spune întrebarea</button>
        <button onclick="citeste()" class="small">🔊 Citește răspunsul</button>
        <button onclick="showLista()" class="secondary small">📚 Lista povestiri</button>
        <button onclick="sterge()" class="secondary small">🧹 Curăță</button>
      </div>

      <div id="raspuns" aria-live="polite"></div>
    </div>
  </div>

  <div class="signature">Făcut de Denis</div>

  <script>
    // Stocare rezumate lungi, în limba română
    const rezumate = {
      "cenușăreasa": `Cenușăreasa este o tânără blândă care trăiește cu mama și surorile vitrege după moartea tatălui. Viața ei e grea, ea muncește în bucătărie și poartă haine rupte. O zână bună o ajută să meargă la bal, îi dă o rochie frumoasă și pantofi de sticlă, dar lasă o condiție: magia ține până la miezul nopții. La bal, prințul rămâne impresionat de ea, dar ea fuge la miezul nopții și pierde un pantof. Prințul pornește să o caute în tot regatul, încercând pantoful pe toate domnișoarele. Cenușăreasa îl probează, iar când pantoful se potrivește, adevărul iese la iveală și ea se căsătorește cu prințul, părăsind viața de servitoare.`,

      "harap alb": `Harap Alb este povestea unui tânăr curajos care pleacă de acasă pentru a-și împlini un jurământ. El trece prin multe încercări, întâlnește personaje fantastice și câștigă prieteni loiali. În drum spre palat el se confruntă cu ispite, capcane și dușmani puternici. Prietenii îl ajută cu talente speciale, iar împreună înving răul. Tema principală este maturizarea, responsabilitatea și rolul prieteniei în biruință.`,

      "amintiri din copilărie": `Amintiri din copilărie descriu viața unui copil în satul tradițional. Nică povestește întâmplări reale, pline de umor, poante și observații vii despre oameni. Autorul surprinde obiceiuri, jocuri, pedepse și lecturi din vremea aceea. Textele arată valoarea memoriei și agreabilitatea limbajului popular. Cititorul înțelege dinamica familiei și a comunității în care a crescut protagonistul.`,

      "povestea lui stan pățitu": `Stan Pățitu este un personaj care trece prin învățături dure. El este păcălit, pierde bani și se întoarce la viață mai precaut. Povestirea subliniază importanța vigilenței și a învățării din greșeli. Tema centrală este maturizarea morală și consecințele încrederii oarbe.`,

      "făt-frumos din lacrimă": `Făt-Frumos din lacrimă este o poveste poetică despre un erou născut dintr-o lacrimă, simbol al purității. El trece prin probe care îi testeză curajul și devotamentul pentru adevăr. Legătura cu iubirea și idealul eroic sunt teme persistente. Finalul aduce restabilirea dreptății și recunoașterea valorii caracterului.`,

      "punguța cu doi bani": `Punguța cu doi bani urmărește viața unui țăran sărac care găsește o mică avere și astfel schimbă destinul familiei sale. După ce un ținut nesăbuit încearcă să-i ia punguța, povestea arată cum istețimea și norocul pot răsplăti perseverența. Temele sunt prudența, hărnicia și consecințele actelor egoiste.`,

      "capra cu trei iezi": `Capra cu trei iezi vorbește despre responsabilitate parentală și pericolele neascultării. Mama capră le dă copiilor reguli clare pentru a nu deschide ușa lupului. Doi iezi sunt păcăliți și mâncați, iar doar cel care a respectat sfatul scapă. După aceea mama se răzbună pe lup, readucând ordinea și învățătura morală a poveștii.`,

      "ursul păcălit de vulpe": `Ursul păcălit de vulpe prezintă confruntarea dintre forță și istețime. Vulpea, cu viclenie, îl păcălește pe urs și îl lasă în dificultate. Povestea subliniază că puterea fără minte poate fi învinsă de inteligență. Mesajul este clar, omul trebuie să folosească mintea, nu doar forța.`,

      "dănilă prepeleac": `Dănilă Prepeleac este un om simplu care face greșeli mari dar nu renunță. El pierde şi câștigă, trece prin situații absurde și învață pe parcurs. Povestea are umor, dar arată și lecții practice despre noroc, prostie și îndemânare. Finalul oferă o răsturnare care te face să regândești judecățile inițiale.`,

      "soacra cu trei nurori": `Soacra cu trei nurori prezintă relații familiale complicate. Narativa compară atitudini, răsplătește hărnicia și pedepseste lenevia. Personajele ilustrează tipare morale și sociale ale satului tradițional. Textul funcționează ca o lecție despre respect și virtute.`,

      "ivan turbincă": `Ivan Turbincă este o poveste despre un soldat isteț care primește o turbincă fermecată. Cu turbinca el păcălește și înfrânge forțe supranaturale. Tema centrală este folosirea inteligenței pentru a scăpa de primejdii. Povestea are umor și elemente fantastice, iar finalul subliniază recompensa istețimii.`,

      "lupul și mielul": `Fabula arată cum puterea poate inventa pretexte pentru a-i face rău celui slab. Personajele sunt simbolice, fiecare reprezintă o atitudine. Moralitatea se citește direct, dreptatea poate fi falsificată de cei puternici. Mesajul este un apel la corectitudine și reflecție.`,

      "meșterul manole": `Balada Meșterul Manole este o poveste tragică despre sacrificiu pentru artă. Meșterii construiesc o mănăstire care nu rezistă, până când un suflet trebuie zidit în piatră pentru ca lucrul să rămână. Tema sacrificiului personal pentru o creație durabilă stă în centrul baladei. Textul ridică întrebări despre prețul frumuseții și obligația creatorului.`,

      "moara cu noroc": `Moara cu noroc urmărește viața lui Ghiță, care pornește cu intenții bune dar e sedus de câștig. Pe măsură ce intră în afaceri, conflictele etice cresc și viața îi devine amenințată. Povestea arată cum lăcomia, frica și compromisurile distrug onoarea. Finalul servește ca avertisment despre prețul pierderii valorilor.`,

      "alexandru lapusneanul": `Povestirea prezintă figura unui domn cu tendințe tiranice care revine pentru răzbunare. Textul expune violența politicii și consecințele brutalității. Tema centrală este abuzul puterii și costul acesteia pentru societate. Personajele secundare oferă contrapunct moral și arată haosul pe care-l lasă în urmă.`,

      "enigma otiliei": `Enigma Otiliei urmărește relațiile complicate dintre moșteniri, iubire și interese sociale. Felix, tânăr prudent, și Otilia, femeie complexă, se află în centrul unui tablou al societății burgheze. Tema e lupta între sentimente sincere și interese materiale. Romanul dezvăluie ipocrizia și mecanismele sociale care influențează alegerile.`,

      "moara cu noroc (rezumat extra)": `Moara cu noroc arată cum tentația banilor alterează caractere. Ghiță se lasă prins în jocuri murdare, iar relațiile se destramă. Autorul descrie mediul, oamenii și transformarea sufletească a protagonistului. Povestea oferă exemple concrete despre cum deciziile mici duc la catastrofe morale.`,

      "la hanul lui mânjoală": `La hanul lui Mânjoală are accente fantastice și satirice. Personajele descoperă secrete și legende care pot schimba percepția realității. Povestirea alternă între umor și mister, iar finalul lasă cititorul cu întrebări despre real și imaginar. Tema este echilibrul dintre credință și rațiune.`,

      "popa tanda": `Popa Tanda este despre un preot care trece de la lene la implicare. El descoperă că exemplul personal schimbă comunitatea. Povestea arată transformarea interioară și responsabilitatea socială. Mesajul este despre puterea schimbării prin acțiuni concrete.`,

      "doamna traista": `Doamna Traista prezintă inventivitatea unei femei care își salvează familia din dificultăți. Ea găsește soluții practice, unele amuzante, care dau speranță comunității. Povestea pune accent pe forța ingeniozității și pe solidaritate.`,

      "povestiri populare extra": `Am inclus aici și alte rezumate scurte. Dacă vrei detalii mai lungi pentru o povestire anume, spune titlul și îți dezvolt pe pagini separate.`
    };

    // Helper: afișează lista de titluri
    function showLista(){
      const titluri = Object.keys(rezumate).map(t => "- " + t).join("\n");
      document.getElementById("raspuns").innerText = "Povestiri disponibile:\n" + titluri + "\n\nScrie: rezumat NUME_POVESTIRE";
    }

    // Sterge input si raspuns
    function sterge(){
      document.getElementById("intrebare").value = "";
      document.getElementById("raspuns").innerText = "";
    }

    // Validare expresie matematica sigura
    function esteCalculValabil(expr){
      // Acceptă cifre, spații, operatori + - * / . ( ) și caractere x și :
      const safe = /^[0-9+\-*/().\sx:]+$/i;
      return safe.test(expr);
    }

    function evalueazaCalcul(expr){
      // Înlocuiește x cu * și : cu /
      const normalized = expr.replace(/x/gi, "*").replace(/:/g, "/");
      // Blochează expresii cu două operatori la rând sau început cu operator invalid
      if (!esteCalculValabil(normalized)) throw "Invalid";
      // Eval într-un mod limitat
      // Folosim Function, dar doar după validare strictă
      try{
        // Prevenim cazuri cu operatori dubli ca "++" sau "**"
        if (/[+\-*/]{2,}/.test(normalized.replace(/\s+/g,''))) throw "Invalid";
        const fn = new Function("return (" + normalized + ")"); 
        const val = fn();
        if (typeof val === "number" && isFinite(val)) return val;
        throw "Invalid";
      }catch(e){
        throw "Invalid";
      }
    }

    let ultimulRaspuns = "";

    function genereazaRaspuns(){
      const raw = document.getElementById("intrebare").value.trim();
      const text = raw.toLowerCase();
      if(!text){
        document.getElementById("raspuns").innerText = "Scrie o întrebare sau un exercițiu.";
        return;
      }

      // 1. Cerere explicită rezumat
      if (text.startsWith("rezumat ") || text.startsWith("rezum ") || text.includes("rezumat")){
        // găsește titlul după cuvântul rezumat
        const after = text.replace(/^rezumat\s*/,'').replace(/^rezum\s*/,'').trim();
        // căutare exactă sau parțială
        let gasit = "";
        if (after){
          for (const key of Object.keys(rezumate)){
            if (after === key || key.includes(after) || after.includes(key)){
              gasit = key; break;
            }
          }
        }
        // dacă nu este nume, încercă să detectezi titlul în propoziție
        if (!gasit){
          for (const key of Object.keys(rezumate)){
            if (text.includes(key)) { gasit = key; break; }
          }
        }
        if (gasit){
          document.getElementById("raspuns").innerText = rezumate[gasit];
          ultimulRaspuns = rezumate[gasit];
          return;
        } else {
          document.getElementById("raspuns").innerText = "Nu am găsit povestea. Folosește butonul Lista povestiri pentru a vedea titlurile exacte.";
          return;
        }
      }

      // 2. Căutare directă titlu (fără cuvânt rezumat)
      for (const key of Object.keys(rezumate)){
        if (text === key || text.includes(key) || key.includes(text)){
          document.getElementById("raspuns").innerText = rezumate[key];
          ultimulRaspuns = rezumate[key];
          return;
        }
      }

      // 3. Calcul matematic
      try{
        // dacă pare un calcul
        if (esteCalculValabil(text)){
          const rez = evalueazaCalcul(text);
          const rasp = "Rezultatul este: " + rez;
          document.getElementById("raspuns").innerText = rasp;
          ultimulRaspuns = rasp;
          return;
        }
      }catch(e){
        // trecem mai departe la explicații
      }

      // 4. Explicații de matematică sau română
      if (text.includes("algebr") || text.includes("ecua")){
        const msg = "Algebra clasei a 6-a include expresii, operatii cu numere, ecuatii simple si rezolvare de probleme. Exemplu concret: x + 5 = 12, atunci x = 7. Dacă ai o ecuație, scrie-o și îți arăt pașii.";
        document.getElementById("raspuns").innerText = msg;
        ultimulRaspuns = msg;
        return;
      }
      if (text.includes("geometr") || text.includes("triunghi") || text.includes("aria")){
        const msg = "Geometria include studiul figuri plane, masurarea unghiurilor si calculul ariilor. Suma unghiurilor unui triunghi este 180 de grade. Scrie o figură sau o problemă și îți arăt cum se calculează.";
        document.getElementById("raspuns").innerText = msg;
        ultimulRaspuns = msg;
        return;
      }
      if (text.includes("fractii") || text.includes("procent") || text.includes("numere prime")){
        const msg = "Pot explica fracții, procente sau noțiuni despre numere prime. Scrie o întrebare concretă sau un exercițiu și îți explic pas cu pas.";
        document.getElementById("raspuns").innerText = msg;
        ultimulRaspuns = msg;
        return;
      }

      // 5. Dacă nu a fost nimic potrivit
      document.getElementById("raspuns").innerText = "Nu am găsit răspunsul. Scrie 'rezumat' urmat de titlu sau pune un calcul. Folosește butonul Lista povestiri pentru a vedea titlurile.";
    }

    // Recunoaștere vocală
    function vorbeste(){
      if (!('webkitSpeechRecognition' in window) && !('SpeechRecognition' in window)){
        alert("Recunoașterea vocală nu este disponibilă în acest browser.");
        return;
      }
      const Rec = window.SpeechRecognition || window.webkitSpeechRecognition;
      const rec = new Rec();
      rec.lang = "ro-RO";
      rec.interimResults = false;
      rec.maxAlternatives = 1;
      rec.start();
      rec.onresult = function(e){
        const spus = e.results[0][0].transcript;
        document.getElementById("intrebare").value = spus;
        genereazaRaspuns();
      };
      rec.onerror = function(){
        // Nu afișăm multe mesaje, doar curățăm
        console.log("Eroare recunoaștere vocală");
      };
    }

    // Citire text cu voce
    function citeste(){
      if (!('speechSynthesis' in window)){
        alert("Citirea cu voce nu este disponibilă în acest browser.");
        return;
      }
      let text = ultimulRaspuns;
      if (!text) text = document.getElementById("raspuns").innerText;
      if (!text) return;
      const utter = new SpeechSynthesisUtterance(text);
      utter.lang = "ro-RO";
      utter.rate = 1;
      utter.pitch = 1;
      window.speechSynthesis.cancel();
      window.speechSynthesis.speak(utter);
    }

    // Tastare Enter pentru a trimite
    document.getElementById("intrebare").addEventListener("keydown", function(e){
      if (e.key === "Enter" && (e.ctrlKey || e.metaKey)){
        genereazaRaspuns();
      }
    });

    // Sugestie: exemplu precompletat pentru testare la prima încărcare
    if (!localStorage.getItem("prim")) {
      document.getElementById("intrebare").value = "rezumat Harap Alb";
      localStorage.setItem("prim","1");
    }
  </script>
</body>
</html>
