<!DOCTYPE html>
<html lang="ro">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>AI Clasa a VI-a â€” RomÃ¢nÄƒ È™i MatematicÄƒ</title>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700&display=swap" rel="stylesheet">
  <style>
    :root{
      --bg1:#0f4c81;
      --bg2:#6a34a5;
      --accent:#00c6ff;
      --card: rgba(255,255,255,0.92);
      --glass: rgba(255,255,255,0.12);
      --maxw:1100px;
      --radius:14px;
    }
    *{box-sizing:border-box}
    html,body{height:100%;margin:0;font-family:Inter,system-ui,Arial;background:linear-gradient(135deg,var(--bg1),var(--bg2));-webkit-font-smoothing:antialiased;color:#052033}
    .wrap{max-width:var(--maxw);margin:18px auto;padding:16px}
    header{display:flex;justify-content:space-between;align-items:center;color:white;padding:12px 0}
    header h1{margin:0;font-size:20px}
    .profile{display:flex;align-items:center;gap:10px}
    .avatar{width:44px;height:44px;border-radius:50%;background:var(--glass);display:flex;align-items:center;justify-content:center;font-weight:700;color:#052033}
    .name{font-weight:600}
    .btn{background:linear-gradient(90deg,var(--accent),#0072ff);border:none;color:white;padding:10px 14px;border-radius:10px;cursor:pointer;font-weight:700}
    .btn.ghost{background:transparent;border:1px solid rgba(255,255,255,0.18);color:white}
    main{display:flex;flex-direction:column;gap:12px;align-items:center}
    .card{width:100%;background:var(--card);border-radius:var(--radius);padding:18px;box-shadow:0 12px 30px rgba(2,6,23,0.12);color:#052033}
    label{font-weight:700;margin-bottom:8px;display:block}
    input,textarea,select{width:100%;padding:10px;border-radius:10px;border:1px solid rgba(3,10,25,0.06);font-size:15px}
    textarea{min-height:140px;resize:vertical}
    .controls{display:flex;gap:10px;flex-wrap:wrap;margin-top:12px}
    #output{margin-top:14px;padding:16px;border-radius:10px;background:var(--glass);color:white;max-height:54vh;overflow:auto;white-space:pre-wrap}
    footer{margin-top:14px;text-align:center;color:rgba(255,255,255,0.9)}
    .modal{position:fixed;inset:0;display:flex;align-items:center;justify-content:center;background:rgba(2,6,23,0.6);z-index:60}
    .modalInner{width:94%;max-width:520px;background:var(--card);border-radius:12px;padding:18px;color:#052033}
    .closeX{float:right;background:transparent;border:none;font-size:20px;cursor:pointer}
    .small{font-size:13px;color:#334}
    .row{display:flex;gap:8px;align-items:center}
    .exerciseRow{display:flex;gap:8px;align-items:center;margin-top:8px}
    @media (max-width:720px){
      header{flex-direction:column;align-items:flex-start;gap:10px}
      .row{flex-direction:column;align-items:stretch}
      .exerciseRow{flex-direction:column;align-items:stretch}
    }
  </style>
</head>
<body>
  <div class="wrap">
    <header>
      <div>
        <h1>AI Clasa a VI-a</h1>
        <div class="small">RomÃ¢nÄƒ, MatematicÄƒ È™i Ã®ntrebÄƒri generale</div>
      </div>
      <div class="profile">
        <div id="avatar" class="avatar">D</div>
        <div style="text-align:right">
          <div id="displayName" class="name">Neautentificat</div>
          <div id="displayEmail" class="small">FoloseÈ™te contul tÄƒu</div>
        </div>
        <button id="openAuth" class="btn">ConecteazÄƒ-te</button>
        <button id="signOut" class="btn ghost" style="display:none">IeÈ™i</button>
      </div>
    </header>

    <main>
      <section class="card" id="askCard">
        <label for="query">Scrie Ã®ntrebarea sau titlul pentru rezumat</label>
        <textarea id="query" placeholder="Ex: rezumat Baltagul, sau 8+9, sau aria dreptunghi 5 3"></textarea>
        <div class="controls">
          <button id="sendBtn" class="btn">Trimite</button>
          <button id="voiceBtn" class="btn">ðŸŽ¤ VorbeÈ™te</button>
          <button id="listBtn" class="btn ghost">Lista poveÈ™ti</button>
          <button id="clearBtn" class="btn ghost">CurÄƒÈ›Äƒ</button>
        </div>
        <div class="exerciseRow">
          <select id="exerciseType" style="width:40%">
            <option value="algebra">Algebra</option>
            <option value="geometrie">Geometrie</option>
            <option value="apartenenÈ›Äƒ">ApartenenÈ›Äƒ</option>
          </select>
          <input id="exerciseInput" placeholder="Ex: 2x+3=11 sau dreptunghi 5 3" />
          <button id="genEx" class="btn ghost">GenereazÄƒ</button>
          <button id="solveEx" class="btn">VerificÄƒ</button>
        </div>
      </section>

      <section class="card" id="outCard" style="display:block">
        <div id="output">AÈ™teaptÄƒ. Scrie o Ã®ntrebare sau apasÄƒ Trimite.</div>
      </section>
    </main>

    <footer>FÄƒcut de Denis Â© 2025</footer>
  </div>

  <div id="authModal" class="modal" style="display:none">
    <div class="modalInner">
      <button id="closeAuth" class="closeX">âœ•</button>
      <h2>Autentificare / ÃŽnregistrare</h2>
      <div id="authError" class="small" style="color:#a02727"></div>

      <div id="loginView">
        <label>Email</label>
        <input id="loginEmail" type="email" placeholder="email@exemplu.com" />
        <label>ParolÄƒ</label>
        <input id="loginPass" type="password" placeholder="ParolÄƒ (min 6 caractere)" />
        <div class="row" style="justify-content:flex-end;margin-top:10px">
          <button id="toRegister" class="btn ghost">ÃŽnregistreazÄƒ-te</button>
          <button id="doLogin" class="btn">ConecteazÄƒ-te</button>
        </div>
      </div>

      <div id="registerView" style="display:none">
        <label>Nume</label>
        <input id="regName" type="text" placeholder="Numele tÄƒu" />
        <label>Email</label>
        <input id="regEmail" type="email" placeholder="Email" />
        <label>ParolÄƒ</label>
        <input id="regPass" type="password" placeholder="ParolÄƒ (min 6 caractere)" />
        <div class="row" style="justify-content:flex-end;margin-top:10px">
          <button id="toLogin" class="btn ghost">ÃŽnapoi</button>
          <button id="doRegister" class="btn">ÃŽnregistreazÄƒ-te</button>
        </div>
      </div>

      <div style="margin-top:12px" class="small">PoÈ›i Ã®nchide fereastra È™i folosi aplicaÈ›ia fÄƒrÄƒ cont.</div>
    </div>
  </div>

<script type="module">
  import { initializeApp } from "https://www.gstatic.com/firebasejs/10.13.0/firebase-app.js";
  import { getAuth, createUserWithEmailAndPassword, signInWithEmailAndPassword, signOut, onAuthStateChanged, updateProfile } from "https://www.gstatic.com/firebasejs/10.13.0/firebase-auth.js";
  import { getFirestore, doc, setDoc, getDoc } from "https://www.gstatic.com/firebasejs/10.13.0/firebase-firestore.js";

  const firebaseConfig = {
    // PASTE HERE YOUR FIREBASE CONFIG OBJECT FROM CONSOLE
    // Ex: apiKey: "...", authDomain: "...", projectId: "...", storageBucket: "...", messagingSenderId: "...", appId: "...", measurementId: "..."
  };

  let app = null;
  let auth = null;
  let db = null;
  try {
    if (firebaseConfig && Object.keys(firebaseConfig).length) {
      app = initializeApp(firebaseConfig);
      auth = getAuth(app);
      db = getFirestore(app);
    }
  } catch(e) {
    console.warn('Firebase not initialized', e);
  }

  const authModal = document.getElementById('authModal');
  const openAuth = document.getElementById('openAuth');
  const closeAuth = document.getElementById('closeAuth');
  const toRegister = document.getElementById('toRegister');
  const toLogin = document.getElementById('toLogin');
  const doLogin = document.getElementById('doLogin');
  const doRegister = document.getElementById('doRegister');
  const loginView = document.getElementById('loginView');
  const registerView = document.getElementById('registerView');
  const authError = document.getElementById('authError');
  const signOutBtn = document.getElementById('signOut');

  openAuth.addEventListener('click', ()=>{ authModal.style.display = 'flex'; authError.innerText=''; });
  closeAuth.addEventListener('click', ()=>{ authModal.style.display = 'none'; authError.innerText=''; });
  toRegister.addEventListener('click', ()=>{ loginView.style.display='none'; registerView.style.display='block'; authError.innerText=''; });
  toLogin.addEventListener('click', ()=>{ registerView.style.display='none'; loginView.style.display='block'; authError.innerText=''; });

  doRegister.addEventListener('click', async ()=>{
    authError.innerText='';
    if (!auth){ authError.innerText='Firebase nu este configurat.'; return; }
    const name = document.getElementById('regName').value.trim();
    const email = document.getElementById('regEmail').value.trim();
    const pass = document.getElementById('regPass').value;
    if (!name || !email || pass.length < 6){ authError.innerText='CompleteazÄƒ corect. ParolÄƒ minim 6 caractere.'; return; }
    try{
      const userCred = await createUserWithEmailAndPassword(auth, email, pass);
      await updateProfile(userCred.user, { displayName: name });
      if (db){
        await setDoc(doc(db, 'users', userCred.user.uid), { name, email });
      }
      authModal.style.display = 'none';
    } catch(err){
      authError.innerText = err.message || 'Eroare la Ã®nregistrare';
    }
  });

  doLogin.addEventListener('click', async ()=>{
    authError.innerText='';
    if (!auth){ authError.innerText='Firebase nu este configurat.'; return; }
    const email = document.getElementById('loginEmail').value.trim();
    const pass = document.getElementById('loginPass').value;
    if (!email || pass.length < 6){ authError.innerText='CompleteazÄƒ email È™i parolÄƒ.'; return; }
    try{
      await signInWithEmailAndPassword(auth, email, pass);
      authModal.style.display = 'none';
    } catch(err){
      authError.innerText = err.message || 'Eroare la autentificare';
    }
  });

  signOutBtn.addEventListener('click', async ()=>{
    if (!auth) return;
    await signOut(auth);
    location.reload();
  });

  async function loadProfile(user){
    if (!user) return;
    let name = user.displayName || '';
    let email = user.email || '';
    if (db){
      try{
        const docRef = doc(db, 'users', user.uid);
        const docSnap = await getDoc(docRef);
        if (docSnap.exists()){
          const data = docSnap.data();
          if (data.name) name = data.name;
        }
      }catch(e){}
    }
    document.getElementById('displayName').innerText = name || (email? email.split('@')[0] : 'Utilizator');
    document.getElementById('displayEmail').innerText = email || '';
    const av = document.getElementById('avatar');
    av.innerText = (name && name[0]) ? name[0].toUpperCase() : (email && email[0]) ? email[0].toUpperCase() : 'D';
    document.getElementById('openAuth').style.display = 'none';
    document.getElementById('signOut').style.display = 'inline-block';
  }

  if (auth){
    onAuthStateChanged(auth, user => {
      if (user) loadProfile(user);
      else {
        document.getElementById('displayName').innerText = 'Neautentificat';
        document.getElementById('displayEmail').innerText = 'FoloseÈ™te contul tÄƒu';
        document.getElementById('openAuth').style.display = 'inline-block';
        document.getElementById('signOut').style.display = 'none';
        document.getElementById('avatar').innerText = 'D';
      }
    });
  }

  // voice recognition
  const voiceBtn = document.getElementById('voiceBtn');
  let recognition = null;
  if ('webkitSpeechRecognition' in window || 'SpeechRecognition' in window){
    const SR = window.SpeechRecognition || window.webkitSpeechRecognition;
    recognition = new SR();
    recognition.lang = 'ro-RO';
    recognition.interimResults = false;
    recognition.maxAlternatives = 1;
    recognition.onresult = (ev) => {
      const txt = ev.results[0][0].transcript;
      document.getElementById('query').value = txt;
    };
    recognition.onerror = (e) => { console.warn('Speech error', e); };
  } else {
    voiceBtn.disabled = true;
    voiceBtn.innerText = 'ðŸŽ¤ Nu e suportat';
  }

  voiceBtn.addEventListener('click', ()=>{
    if (!recognition){ alert('RecunoaÈ™tere vocalÄƒ indisponibilÄƒ.'); return; }
    recognition.start();
  });

  // quick utilities
  function escapeHtml(s){ return String(s).replace(/[&<>"']/g, c=>({'&':'&amp;','<':'&lt;','>':'&gt;','"':'&quot;',"'":'&#39;'})[c]); }
  function isMathExpr(s){ return /^[0-9\s+\-*/().:x]+$/.test(s); }
  function safeEval(expr){
    const norm = expr.replace(/x/g,'*').replace(/:/g,'/');
    if (!/^[0-9+\-*/().\s]+$/.test(norm)) throw 'invalid';
    return Function('"use strict";return ('+norm+')')();
  }

  // partial list of 20 rezumate detaliate
  const summaries = {
    "baltagul": "Baltagul, roman de Mihail Sadoveanu, urmÄƒreÈ™te cÄƒutarea Vitoriei Lipan. Ea pleacÄƒ sÄƒ afle soarta soÈ›ului dispÄƒrut. ÃŽn drum ea strÃ¢nge indicii, foloseÈ™te tradiÈ›ii È™i intuiÈ›ie. Finalul aratÄƒ dreptatea restabilitÄƒ, È™i valoarea demnitÄƒÈ›ii umane. Tema centralÄƒ este lupta pentru adevÄƒr È™i rolul femeii Ã®n comunitate.",
    "amintiri din copilÄƒrie": "Amintiri din copilÄƒrie de Ion CreangÄƒ evocÄƒ Ã®ntÃ¢mplÄƒri din satul HumuleÈ™ti. NicÄƒ e prezentat cu umor, cu nÄƒzdravÄƒnii, cu È™otii È™i cu lecÈ›ii. Textul are valoare etnograficÄƒ È™i emoÈ›ionalÄƒ. Vocea narativÄƒ este caldÄƒ, sincerÄƒ È™i plinÄƒ de regionalisme.",
    "harap alb": "Harap-Alb, prelucrat de Ion CreangÄƒ, este un basm complex. Eroul trece prin probe È™i Ã®nvaÈ›Äƒ ce Ã®nseamnÄƒ responsabilitatea. Prietenii lui posedÄƒ daruri care Ã®mpreunÄƒ asigurÄƒ biruinÈ›a. Povestea are tensiune moralÄƒ, umor È™i simboluri de iniÈ›iere.",
    "fata babei si fata mosneagului": "Basm popular despre douÄƒ fete cu soarte diferitÄƒ. HÄƒrnicia e rÄƒsplÄƒtitÄƒ, lenea e pedepsitÄƒ. Textul transmite o moralÄƒ clarÄƒ despre muncÄƒ È™i cinste.",
    "punguÈ›a cu doi bani": "Povestea aratÄƒ consecinÈ›ele norocului È™i lÄƒcomiei. Personajele reacÈ›ioneazÄƒ diferit la avere, iar morala e despre cumpÄƒtare È™i dreptate.",
    "capra cu trei iezi": "Capra cu trei iezi este o lecÈ›ie despre ascultare. Mama avertizeazÄƒ, iar cei care nu ascultÄƒ plÄƒtesc. Povestea e dramaticÄƒ, dar educativÄƒ.",
    "ivan turbinca": "Ivan TurbincÄƒ foloseÈ™te umorul popular pentru a arÄƒta isteÈ›imea. Soldatul iese biruitor cu ajutorul unei turbinde magice, iar satira socialÄƒ este prezentÄƒ.",
    "pupaza din tei": "Povestire din copilÄƒrie, cu umor È™i consecinÈ›e. NicÄƒ prinde o pupÄƒzÄƒ È™i Ã®nvaÈ›Äƒ despre responsabilitate È™i risc.",
    "micul print": "Micul PrinÈ› de Saint-ExupÃ©ry e o meditaÈ›ie despre prietenie È™i sens. Personajul Ã®nvaÈ›Äƒ valoarea legÄƒturilor. Cartea foloseÈ™te simboluri È™i un ton poetic.",
    "sarea in bucate": "Basm cu moralÄƒ, despre recunoaÈ™terea iubirii. Testul cu sarea aratÄƒ cÃ¢t de mult preÈ›uieÈ™te cineva lucrurile fireÈ™ti.",
    "soacra cu trei nurori": "Un test moral Ã®n care hÄƒrnicia e rÄƒsplÄƒtitÄƒ. Povestea e clarÄƒ È™i foloseÈ™te motive populare.",
    "urss"? : "Aceasta intrare e un placeholder si poate fi Ã®nlocuitÄƒ cu o altÄƒ povestire.",
    "d-l goe": "SchiÈ›Äƒ de Caragiale care ironizeazÄƒ lipsa educaÈ›iei. Comicul vine din contrastul dintre comportament È™i aÈ™teptÄƒri sociale.",
    "moara cu noroc": "NuvelÄƒ de Ioan Slavici despre lÄƒcomie È™i distrugere moralÄƒ. Personajele sunt complexe, iar finalul serveÈ™te ca avertisment.",
    "plumb": "Poezie de George Bacovia care redÄƒ depresie È™i tÄƒcere. Simbolul plumbului exprimÄƒ greutatea sufleteascÄƒ.",
    "miorita": "BaladÄƒ despre destin È™i acceptare. Ciobanul Ã®È™i primeÈ™te soarta cu demnitate, iar natura e martor.",
    "prÃ¢slea": "Legenda lui PrÃ¢slea aratÄƒ curajul È™i recompensa. Eroul trece probe pentru a dovedi valoarea sa.",
    "greuceanu": "Basm despre erou È™i luptÄƒ, cu elemente mitice. Tema restaurÄƒrii ordinii este centralÄƒ.",
    "poveste moderna 1": "Text contemporan pentru elevi despre prietenie È™i responsabilitate.",
    "poveste moderna 2": "Adaptare modernÄƒ a unui motiv clasic, plasatÄƒ Ã®n mediul urban."
  };

  // send, list, clear, exercises
  document.getElementById('sendBtn').addEventListener('click', handleQuery);
  document.getElementById('listBtn').addEventListener('click', ()=> {
    const keys = Object.keys(summaries).sort();
    document.getElementById('output').innerText = 'PoveÈ™ti disponibile:\n\n' + keys.map(k=>'â€¢ '+k).join('\n');
  });
  document.getElementById('clearBtn').addEventListener('click', ()=> {
    document.getElementById('query').value = '';
    document.getElementById('output').innerText = '';
  });

  document.getElementById('genEx').addEventListener('click', ()=> {
    const t = document.getElementById('exerciseType').value;
    const input = document.getElementById('exerciseInput');
    if (t==='algebra'){
      const a = Math.floor(Math.random()*5)+1;
      const x = Math.floor(Math.random()*8)+1;
      const b = Math.floor(Math.random()*10);
      const c = a*x + b;
      input.value = `${a}x + ${b} = ${c}`;
    } else if (t==='geometrie'){
      const l = Math.floor(Math.random()*8)+2;
      const w = Math.floor(Math.random()*6)+2;
      input.value = `dreptunghi ${l} ${w}`;
    } else {
      const sets = [[1,2,3],[4,5,6],[5,6,7]];
      const s = sets[Math.floor(Math.random()*sets.length)];
      const el = s[Math.floor(Math.random()*s.length)];
      input.value = `{${s.join(',')}} element=${el}`;
    }
  });

  document.getElementById('solveEx').addEventListener('click', ()=> {
    const t = document.getElementById('exerciseType').value;
    const val = document.getElementById('exerciseInput').value.trim();
    const out = document.getElementById('output');
    if (!val){ out.innerText = 'Scrie exerciÈ›iul.'; return; }
    if (t==='algebra'){
      out.innerText = handleAlgebra(val);
    } else if (t==='geometrie'){
      out.innerText = handleGeometry(val);
    } else {
      const setMatch = val.match(/\{([^}]+)\}/);
      const elemMatch = val.match(/element\s*=?\s*([^\s,}]+)/);
      if (setMatch && elemMatch){
        const arr = setMatch[0].replace(/[{}]/g,'').split(',').map(x=>x.trim());
        let el = elemMatch[1];
        if (/^-?\d+$/.test(el)) el = parseInt(el,10);
        out.innerText = arr.some(v=>String(v)===String(el)) ? `Da, ${el} aparÈ›ine mulÈ›imii ${setMatch[0]}` : `Nu, ${el} nu aparÈ›ine mulÈ›imii ${setMatch[0]}`;
      } else out.innerText = 'Format invalid.';
    }
  });

  function handleAlgebra(eq){
    const compact = eq.replace(/\s+/g,'');
    const m = compact.match(/^([0-9]*)x?([+\-][0-9]+)?=([+\-]?[0-9]+)$/i);
    if (!m) return 'Format necunoscut. Ex: 2x + 3 = 11';
    let a = m[1]===''?1:parseInt(m[1],10);
    if (compact.indexOf('x')===-1) a = 0;
    let b = m[2]?parseInt(m[2],10):0;
    let c = parseInt(m[3],10);
    if (a===0) return 'Nu existÄƒ variabilÄƒ x.';
    const x = (c - b)/a;
    return `EcuaÈ›ie: ${eq}\nPaÈ™i:\n1. MutÄƒm termenii liberi: ${a}x = ${c} - (${b}) = ${c-b}\n2. ÃŽmpÄƒrÈ›im la ${a}: x = ${(c-b)}/${a} = ${x}`;
  }

  function handleGeometry(text){
    const t = text.toLowerCase();
    if (t.includes('dreptunghi') && t.includes('aria')){
      const nums = t.match(/[-+]?\d*\.?\d+/g) || [];
      if (nums.length>=2){
        const l=parseFloat(nums[0]), w=parseFloat(nums[1]);
        return `Dreptunghi L=${l}, l=${w}\nAria = L Ã— l = ${l*w}`;
      } else return 'Scrie: aria dreptunghi L l.';
    }
    if (t.includes('dreptunghi') && t.includes('perim')){
      const nums = t.match(/[-+]?\d*\.?\d+/g) || [];
      if (nums.length>=2){
        const l=parseFloat(nums[0]), w=parseFloat(nums[1]);
        return `Perimetrul = 2 Ã— (L + l) = ${2*(l+w)}`;
      } else return 'Scrie: perimetrul dreptunghi L l.';
    }
    if (t.includes('triunghi') && t.includes('aria')){
      const nums = t.match(/[-+]?\d*\.?\d+/g) || [];
      if (nums.length>=2){
        const b=parseFloat(nums[0]), h=parseFloat(nums[1]);
        return `Aria triunghi = (b Ã— h) / 2 = ${(b*h)/2}`;
      } else return 'Scrie: aria triunghi baza Ã®nÄƒlÈ›ime.';
    }
    if (t.includes('cerc')){
      const nums = t.match(/[-+]?\d*\.?\d+/g) || [];
      if (nums.length>=1){
        const r=parseFloat(nums[0]); return `Cerc r=${r}\nAria = Ï€ Ã— rÂ² = ${(Math.PI*r*r).toFixed(3)}\nCircumferinÈ›a = ${ (2*Math.PI*r).toFixed(3) }`;
      } else return 'Scrie: cerc r.';
    }
    return 'SpecificÄƒ figura È™i valorile.';
  }

  // end part 1
</script>
</body>
</html>
// CONTINUARE - LipeÈ™te aceastÄƒ parte imediat dupÄƒ Partea 1, Ã®nainte de </script></body></html>

<script>
  // adaug Ã®ncÄƒ 20 de rezumate pentru total ~40
  summaries["cenusareasa"] = "CenuÈ™Äƒreasa este o fatÄƒ blÃ¢ndÄƒ È™i harnicÄƒ, abuzatÄƒ de mama vitregÄƒ È™i surorile vitrege. O zÃ¢nÄƒ Ã®i oferÄƒ o rochie È™i pantofi pentru balul la care vine prinÈ›ul. Ea fuge la miezul nopÈ›ii È™i lasÄƒ un pantof, iar prinÈ›ul porneÈ™te Ã®n cÄƒutarea posesoarei. Povestea aratÄƒ cÄƒ bunÄƒtatea È™i rÄƒbdarea sunt rÄƒsplÄƒtite.";
  summaries["scufita rosie"] = "ScufiÈ›a RoÈ™ie merge la bunica cu merinde, dar este pÄƒcÄƒlitÄƒ de lup. Unele variante se terminÄƒ cu salvarea de cÄƒtre vÃ¢nÄƒtor. Povestea avertizeazÄƒ copiii sÄƒ nu vorbeascÄƒ cu strÄƒinii.";
  summaries["povestea porcului"] = "O tÃ¢nÄƒrÄƒ se cÄƒsÄƒtoreÈ™te cu un porcuÈ™or care se transformÄƒ noaptea Ã®n om. Ea trebuie sÄƒ-l gÄƒseascÄƒ È™i sÄƒ Ã®nvingÄƒ vrÄƒji pentru a rupe blestemul. Tema este credinÈ›a È™i perseverenÈ›a Ã®n iubire.";
  summaries["prÃ¢slea cel voinic"] = "PrÃ¢slea, erou popular, trece prin probe pentru a salva merele de aur. El Ã®nvinge primejdii È™i este rÄƒsplÄƒtit. Basmul susÈ›ine curajul È™i loialitatea.";
  summaries["greuceanu"] = "Greuceanu Ã®nfruntÄƒ forÈ›e supranaturale pentru a restabili ordinea. Povestea conÈ›ine motive solare È™i lupte simbolice Ã®ntre bine È™i rÄƒu.";
  summaries["punguÈ›a cu doi bani"] = "Povestea unui noroc mic care schimbÄƒ viaÈ›a personajului dar aratÄƒ È™i reacÈ›iile comunitÄƒÈ›ii. Tema este cumpÄƒtarea.";
  summaries["ivan turbinÃ§a"] = "Umor È™i isteÈ›ime popularÄƒ Ã®ntr-o poveste Ã®n care soldatul pÄƒcÄƒleÈ™te moartea È™i lumea se schimbÄƒ pentru el.";
  summaries["poveste noua 3"] = "Text modern despre prietenie care testeazÄƒ responsabilitatea. Personajele Ã®nvaÈ›Äƒ sÄƒ colaboreze È™i ajung la soluÈ›ii practice.";
  summaries["poveste noua 4"] = "Poveste contemporanÄƒ despre acceptare È™i diferenÈ›e. Personajele acceptÄƒ diversitatea È™i rezolvÄƒ conflicte prin dialog.";
  summaries["poveste noua 5"] = "O povestire scurtÄƒ despre ajutor reciproc, potrivitÄƒ pentru È™coalÄƒ. Paragrafe cu exemple practice È™i concluzie moralÄƒ.";
  summaries["d-l goe"] = "Goe este un copil rÄƒsfÄƒÈ›at care comportÄƒ nepoliticos. Caragiale foloseÈ™te situaÈ›ia pentru a ironiza educaÈ›ia neadecvatÄƒ a copiilor din familii bogate.";
  summaries["moara cu noroc"] = "GhiÈ›Äƒ preia hanul Moara cu noroc, dar lÄƒcomia Ã®l duce la ruinÄƒ. Nuvela ilustreazÄƒ corupÈ›ia moralÄƒ provocatÄƒ de dorinÈ›a de Ã®mbogÄƒÈ›ire.";
  summaries["maria tanase poveste"] = "Text modern despre o fatÄƒ din sat care Ã®È™i pÄƒstreazÄƒ demnitatea Ã®n faÈ›a greutÄƒÈ›ilor. Exemplu de curaj È™i responsabilitate.";
  summaries["marin sorescu poveste"] = "O povestire scurtÄƒ cu umor negru, tipicÄƒ lui Marin Sorescu. Mesajul este adesea ironic, cu final neaÈ™teptat.";
  summaries["sadoveanu fragment"] = "Fragmente care ilustreazÄƒ natura ca personaj, ritmuri tradiÈ›ionale È™i sensuri morale profunde. Exemple de investigaÈ›ie È™i onestitate.";
  summaries["alegoria timpului"] = "Un text didactic care explicÄƒ metafore despre trecerea timpului È™i maturizare. Potrivit pentru clasa a 6-a.";
  summaries["fabula vulpea si corbul"] = "Fabula aratÄƒ cum lauda poate pÄƒcÄƒli, vulpea linguÈ™eÈ™te corbul pentru a-i lua brÃ¢nza. Morala: nu crede lauda nefondatÄƒ.";
  summaries["fata din dafin"] = "Basm romantic despre o fatÄƒ care trece prin Ã®ncercÄƒri pentru a-È™i gÄƒsi iubirea. Tema sacrificiului È™i a sacrificiului reciproc.";
  summaries["poveste urbana"] = "Adaptare modernÄƒ a motivelor clasice Ã®n mediul oraÈ™ului mic. Probleme actuale, soluÈ›ii practice È™i morale clare.";
  summaries["poveste scurta 40"] = "Text scurt pentru recapitulare, care sintetizeazÄƒ motivele clasice È™i lecÈ›iile practice.";

  // funcÈ›ie principalÄƒ care trateazÄƒ inputul
  function handleQuery(){
    const raw = document.getElementById('query').value.trim();
    const out = document.getElementById('output');
    if (!raw){ out.innerText = 'Scrie o Ã®ntrebare sau un titlu.'; return; }
    const text = raw.toLowerCase();

    // calcul matematic simplu
    if (isMathExpr(text)){
      try{
        const res = safeEval(text);
        out.innerText = `Rezultat: ${res}`;
        return;
      }catch(e){}
    }

    // ecuaÈ›ie de formÄƒ ax + b = c
    if (/x/.test(text) && /=/.test(text)){
      out.innerText = handleAlgebra(raw);
      return;
    }

    // geometrie
    if (text.includes('aria') || text.includes('perim') || text.includes('dreptunghi') || text.includes('triunghi') || text.includes('cerc')){
      out.innerText = handleGeometry(text);
      return;
    }

    // apartenenÈ›Äƒ mulÈ›imi
    if (text.includes('{') && text.includes('element')){
      const setMatch = text.match(/\{([^}]+)\}/);
      const elemMatch = text.match(/element\s*=?\s*([^\s,}]+)/);
      if (setMatch && elemMatch){
        const arr = setMatch[0].replace(/[{}]/g,'').split(',').map(x=>x.trim());
        let elem = elemMatch[1];
        if (/^-?\d+$/.test(elem)) elem = parseInt(elem,10);
        const belongs = arr.some(v => String(v) === String(elem));
        out.innerText = belongs ? `Da, ${elem} aparÈ›ine mulÈ›imii ${setMatch[0]}` : `Nu, ${elem} nu aparÈ›ine mulÈ›imii ${setMatch[0]}`;
        return;
      }
    }

    // cÄƒutare rezumate exacte sau parÈ›iale
    for (const key of Object.keys(summaries)){
      if (text.includes(key)){
        out.innerHTML = `<strong>${key.toUpperCase()}</strong>\n\n${escapeHtml(summaries[key])}`;
        return;
      }
    }

    // rÄƒspunsuri generale
    const g = generalAnswers(text);
    if (g){ out.innerText = g; return; }

    out.innerText = "Nu am gÄƒsit exact, Ã®ncearcÄƒ 'rezumat TITLU' sau un calcul sau foloseÈ™te Lista poveÈ™ti.";
  }

  // completare rÄƒspunsuri generale
  function generalAnswers(t){
    if (t.includes('mihai eminescu') || t.includes('cine a fost eminescu')) return 'Mihai Eminescu (1850-1889), poet romÃ¢n, autorul LuceafÄƒrului.';
    if (t.includes('capitala romaniei') || t.includes('capitala romÃ¢niei') || t.includes('bucuresti')) return 'Capitala RomÃ¢niei este BucureÈ™ti.';
    if (t.includes('cate continente') || t.includes('cÃ¢te continente')) return 'ExistÄƒ 7 continente: Europa, Asia, Africa, America de Nord, America de Sud, Australia È™i Antarctica.';
    if (t.includes('cine a scris baltagul') || t.includes('autor baltagul')) return 'Baltagul a fost scris de Mihail Sadoveanu.';
    if (t.includes('ce este o faba') || t.includes('fabulÄƒ')) return 'Fabula este o povestire scurtÄƒ, moralizatoare, adesea cu animale ca personaje.';
    return null;
  }

  // face butoanele funcÈ›ionale È™i enter
  document.getElementById('sendBtn').addEventListener('click', handleQuery);
  document.getElementById('query').addEventListener('keydown', (e)=>{ if (e.key === 'Enter' && (e.ctrlKey || e.metaKey)) handleQuery(); });

  // finalizez iniÈ›ializarea pentru auth (dacÄƒ existÄƒ)
  if (auth){
    onAuthStateChanged(auth, async (user)=>{
      if (user) {
        await loadProfile(user);
      } else {
        document.getElementById('displayName').innerText = 'Neautentificat';
        document.getElementById('displayEmail').innerText = 'FoloseÈ™te contul tÄƒu';
        document.getElementById('openAuth').style.display = 'inline-block';
        document.getElementById('signOut').style.display = 'none';
        document.getElementById('avatar').innerText = 'D';
      }
    });
  }

  // small polish: enable buttons after auth changes
  const allButtons = ['sendBtn','voiceBtn','listBtn','clearBtn','genEx','solveEx'];
  for (const id of allButtons){
    const el = document.getElementById(id);
    if (el) el.disabled = false;
  }

  // asigur compatibilitate speech recognition start/stop
  if (recognition){
    recognition.onend = ()=>{ /* ready for next */ };
  }

  // adaug un apel pentru a arata lista initiala la prima incarcare (opÈ›ional)
  // document.getElementById('listBtn').click();

  // Ã®ncheiere script total
</script>

</body>
</html>
