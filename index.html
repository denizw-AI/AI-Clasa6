<!doctype html>
<html lang="ro">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Autentificare — AI Clasa a VI-a</title>
  <style>
    :root{--bg:linear-gradient(135deg,#0f4c81,#6a34a5);--card:rgba(255,255,255,0.95)}
    *{box-sizing:border-box}
    body{margin:0;height:100vh;display:flex;align-items:center;justify-content:center;background:var(--bg);font-family:Inter,system-ui,Arial;color:#072032}
    .modal{width:420px;background:var(--card);border-radius:14px;padding:18px;box-shadow:0 12px 28px rgba(0,0,0,0.25)}
    h2{margin:0 0 8px 0}
    .row{display:flex;gap:8px;align-items:center}
    label{font-weight:700;margin-top:8px;display:block}
    input{width:100%;padding:10px;border-radius:10px;border:1px solid rgba(0,0,0,0.08);font-size:15px}
    .actions{display:flex;gap:8px;justify-content:flex-end;margin-top:12px}
    button{padding:10px 12px;border-radius:10px;border:none;cursor:pointer;font-weight:700}
    .btn-primary{background:#0b66ff;color:white}
    .btn-outline{background:transparent;border:1px solid rgba(0,0,0,0.06)}
    .closeX{position:absolute;right:18px;top:18px;background:transparent;border:none;font-size:18px;cursor:pointer}
    .note{font-size:13px;color:#334;margin-top:8px}
    .container{position:relative}
    .link-small{background:transparent;border:none;color:#0b66ff;cursor:pointer;padding:0;font-weight:700}
    @media (max-width:480px){.modal{width:94%}}
  </style>
</head>
<body>
  <div class="container">
    <button class="closeX" id="cancelBtn" title="Renunță">✕</button>
    <div class="modal" role="dialog" aria-modal="true">
      <h2>Conectare sau Înregistrare</h2>

      <div id="loginBox">
        <label for="loginEmail">Email</label>
        <input id="loginEmail" type="email" placeholder="email@exemplu.com" />
        <label for="loginPass">Parolă</label>
        <input id="loginPass" type="password" placeholder="Parolă (min 6 caractere)" />
        <div class="actions">
          <button class="btn-outline" id="toRegister">Înregistrează-te</button>
          <button class="btn-primary" id="doLogin">Conectează-te</button>
        </div>
      </div>

      <div id="registerBox" style="display:none">
        <label for="regName">Nume</label>
        <input id="regName" type="text" placeholder="Numele tău" />
        <label for="regEmail">Email</label>
        <input id="regEmail" type="email" placeholder="email@exemplu.com" />
        <label for="regPass">Parolă</label>
        <input id="regPass" type="password" placeholder="Parolă (min 6 caractere)" />
        <div class="actions">
          <button class="btn-outline" id="backToLogin">Înapoi</button>
          <button class="btn-primary" id="doRegister">Înregistrează-te</button>
        </div>
      </div>

      <div class="note">
        Poți folosi aplicația fără cont, dar datele nu se salvează în cloud.
      </div>

      <div id="authError" style="color:#b00020;margin-top:10px"></div>
    </div>
  </div>

  <script type="module">
    // Import Firebase modular SDK (versiune compatibilă browser)
    import { initializeApp } from "https://www.gstatic.com/firebasejs/10.13.0/firebase-app.js";
    import { getAuth, createUserWithEmailAndPassword, signInWithEmailAndPassword } from "https://www.gstatic.com/firebasejs/10.13.0/firebase-auth.js";
// Import the functions you need from the SDKs you need
import { initializeApp } from "firebase/app";
import { getAnalytics } from "firebase/analytics";
// TODO: Add SDKs for Firebase products that you want to use
// https://firebase.google.com/docs/web/setup#available-libraries

// Your web app's Firebase configuration
// For Firebase JS SDK v7.20.0 and later, measurementId is optional
const firebaseConfig = {
  apiKey: "AIzaSyAkQaOIVHSYzIsGB6xB8ekPvzGsfF_78Tg",
  authDomain: "denizw111.firebaseapp.com",
  projectId: "denizw111",
  storageBucket: "denizw111.firebasestorage.app",
  messagingSenderId: "1004600733897",
  appId: "1:1004600733897:web:7e030dd1ec461c272f1d18",
  measurementId: "G-CWWGTGV8RF"
};

// Initialize Firebase
const app = initializeApp(firebaseConfig);
const analytics = getAnalytics(app);
    // Verifică că ai pus config
    if (typeof firebaseConfig === 'undefined') {
      console.warn('firebaseConfig nu este setat. Adaugă blocul tău Firebase în login.html.');
    }

    // Initialize app doar dacă config este definit
    let auth = null;
    try {
      if (typeof firebaseConfig !== 'undefined') {
        const app = initializeApp(firebaseConfig);
        auth = getAuth(app);
      }
    } catch (e) {
      console.error('Eroare inițializare Firebase', e);
    }

    // UI
    const loginBox = document.getElementById('loginBox');
    const registerBox = document.getElementById('registerBox');
    const toRegister = document.getElementById('toRegister');
    const backToLogin = document.getElementById('backToLogin');
    const doLogin = document.getElementById('doLogin');
    const doRegister = document.getElementById('doRegister');
    const cancelBtn = document.getElementById('cancelBtn');
    const authError = document.getElementById('authError');

    toRegister.addEventListener('click', ()=>{ loginBox.style.display='none'; registerBox.style.display='block'; authError.innerText=''; });
    backToLogin.addEventListener('click', ()=>{ registerBox.style.display='none'; loginBox.style.display='block'; authError.innerText=''; });

    // Cancel X => duce la app.html în modul guest (fără autentificare)
    cancelBtn.addEventListener('click', ()=>{ window.location.href = 'app.html'; });

    // Register
    doRegister.addEventListener('click', async ()=>{
      authError.innerText = '';
      if (!auth){ authError.innerText = 'Firebase nu este configurat.'; return; }
      const name = document.getElementById('regName').value.trim();
      const email = document.getElementById('regEmail').value.trim();
      const pass = document.getElementById('regPass').value;
      if (!name || !email || pass.length < 6){ authError.innerText = 'Completează corect, parola minim 6 caractere.'; return; }
      try{
        await createUserWithEmailAndPassword(auth, email, pass);
        // La înregistrare revin la login
        loginBox.style.display='block'; registerBox.style.display='none';
        authError.style.color='green';
        authError.innerText = 'Cont creat. Poți să te conectezi.';
      }catch(err){
        authError.style.color='red';
        authError.innerText = err.message || 'Eroare la înregistrare';
      }
    });

    // Login
    doLogin.addEventListener('click', async ()=>{
      authError.innerText = '';
      if (!auth){ authError.innerText = 'Firebase nu este configurat.'; return; }
      const email = document.getElementById('loginEmail').value.trim();
      const pass = document.getElementById('loginPass').value;
      if (!email || pass.length < 6){ authError.innerText = 'Completează email și parolă.'; return; }
      try{
        await signInWithEmailAndPassword(auth, email, pass);
        // la login revin în app.html (pagina principală) — app.html va detecta userul
        window.location.href = 'app.html';
      }catch(err){
        authError.style.color='red';
        authError.innerText = err.message || 'Eroare la autentificare';
      }
    });
  </script>
</body>
</html>
